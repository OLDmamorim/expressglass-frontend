<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <title>EXPRESSGLASS • Agendamentos</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="app">
    <!-- O teu conteúdo existente (header, tabelas, modais, etc.) -->
  </div>

  <!-- Scripts -->
  <script src="api.js"></script>
  <script src="script.js?v=smbraga_2025-09-21_01"></script>

  <!-- >>>>>> SCRIPT DE IMPRESSÃO (garantir preenchimento antes de imprimir) <<<<<< -->
  <script>
    function fillPrintSectionsSafely(){
      try{ if (typeof renderAll === 'function') renderAll(); }catch(e){}
      try{ if (typeof window.fillPrintFromAppointments === 'function') window.fillPrintFromAppointments(); }catch(e){}
    }
    window.onbeforeprint = fillPrintSectionsSafely;
    document.getElementById('printPage')?.addEventListener('click', ()=>{
      fillPrintSectionsSafely();
      setTimeout(()=>window.print(), 20);
    });
  </script>
</body>
</html>